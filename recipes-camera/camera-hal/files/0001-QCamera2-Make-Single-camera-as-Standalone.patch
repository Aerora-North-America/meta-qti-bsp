From 88d86febe8f3a8aba443ffcab1bb5d4d2cf764ce Mon Sep 17 00:00:00 2001
From: Chandan Gera <cgera@codeaurora.org>
Date: Wed, 12 Oct 2016 21:26:02 +0530
Subject: [PATCH] QCamera2: Make Single camera as Standalone

Issue:
Even if single camera is detected HAL is
making it as Main camera whereas it should be
treated as STANALONE.

Fix:
Donot sort cameras if only one camera is detected.

Change-Id: I1d31a0762a63e76f6160e98e276c8a691d5225b0
CRs-Fixed: 1077031
---
 QCamera2/stack/mm-camera-interface/src/mm_camera_interface.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/QCamera2/stack/mm-camera-interface/src/mm_camera_interface.c b/QCamera2/stack/mm-camera-interface/src/mm_camera_interface.c
index ae7648c..6b203f7 100644
--- a/QCamera2/stack/mm-camera-interface/src/mm_camera_interface.c
+++ b/QCamera2/stack/mm-camera-interface/src/mm_camera_interface.c
@@ -2728,7 +2728,12 @@ uint8_t get_num_of_cameras()
     g_cam_ctrl.num_cam = num_cameras;
 
     get_sensor_info();
-    sort_camera_info(g_cam_ctrl.num_cam);
+    if (g_cam_ctrl.num_cam > 1) {
+        sort_camera_info(g_cam_ctrl.num_cam);
+    } else if (g_cam_ctrl.num_cam == 1) {
+        g_cam_ctrl.cam_type[0] = CAM_TYPE_STANDALONE;
+    }
+
     /* unlock the mutex */
     pthread_mutex_unlock(&g_intf_lock);
     LOGI("num_cameras=%d\n", (int)g_cam_ctrl.num_cam);
-- 
1.9.1

