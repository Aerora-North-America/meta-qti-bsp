#@TYPE: Machine
#@NAME: SA2150P
#@DESCRIPTION: Machine configuration for QTI SA2150P

require conf/machine/include/qcs40x.inc

PREFERRED_PROVIDER_virtual/kernel = "linux-msm"
PREFERRED_VERSION_linux-msm = "5.4"
KERNEL_IMAGETYPE = "Image.gz"
KERNEL_BASE = "0x80000000"
KERNEL_TAGS_OFFSET = "0x1e00000"
KERNEL_CONFIG ?= "vendor/sa2150p-qgki_defconfig"
KERNEL_CONFIG_qti-distro-debug ?= "vendor/sa2150p-qgki-debug_defconfig"
KERNEL_CMD_PARAMS = "noinitrd ro rootwait console=ttyMSM0,115200,n8 no_console_suspend=1 androidboot.hardware=qcom androidboot.console=ttyMSM0 lpm_levels.sleep_disabled=1 service_locator.enable=1 firmware_class.path=/lib/firmware/updates msm_rtb.filter=0x237"
KERNEL_DYNAMIC_DEFCONFIG = "True"
KERNEL_DTB_NAMES    = "vendor/qcom/sa2150p-ccard-emmc.dtb"

SERIAL_CONSOLES = "115200;ttyMSM0"

# Bootloader configuration
EXTRA_IMAGEDEPENDS += "edk2"

# Build architecture configuration
DEFAULTTUNE = "aarch64"

# MACHINE_FEATURES ##
# qti-adsp:               Machine supports QTI adsp solution
# qti-cdsp:               Machine supports QTI cdsp solution
# qti-ab-boot:            Machine supports a/b boot
# qti-security:           Machine supports QTI security solution
# dm-verity-bootloader:   Machine supports bootloader-based dm-verity implementation
# qti-wifi:               Machine supports QTI WiFi solution
# qti-audio:              Machine supports QTI audio solution
# qti-bluetooth:          Machine supports QTI bluetooth solution
# qti-sensors:            Machine supports sensors qti solution
# qti-location:           Machine supports Location solution
# qti-data-modem:         Machine supports QTI data modem solution
# qti-external-ap         Machine supports QTI external AP solution
# qti-cv2x:               Machine supports QTI Cellular V2X solution

MACHINE_FEATURES += "qti-security qti-location qti-external-ap"

# Temporary addition, these distro features will be converted to machine features
DISTRO_FEATURES_remove = " emmc-boot"
DISTRO_FEATURES_append = " nand-boot"

MACHINE_MNT_POINTS = " \
    /firmware \
    /persist \
    /cache \
    /data \
    /systemrw \
"

# Formats of root filesystem images
IMAGE_FSTYPES = "ubi"
MACHINE_SUPPORTS_PDMAPPER = "False"
MACHINE_SUPPORTS_INIT_RAMDISK = "False"

# Sizes for UBI volumes
SYSTEM_VOLUME_SIZE   = "150MiB"
CACHE_VOLUME_SIZE    = "81MiB"
SYSTEMRW_VOLUME_SIZE = "6MiB"
PERSIST_VOLUME_SIZE  = "12MiB"

UBINIZE_ARGS = "-m 4096 -p 256KiB -s 4096"
MKUBIFS_ARGS = "-m 4096 -e 253952 -c 2146 -F"

USBCOMPOSITION      = "901D"
