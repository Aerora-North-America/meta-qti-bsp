#@TYPE: Machine
#@NAME: qrb5165-rb5 dev kit
#@DESCRIPTION: Machine configuration for RB5 dev kit based on QCS8250

require conf/machine/include/qrb5165.inc

KERNEL_IMAGETYPE   = "Image.gz"
KERNEL_DTB_NAMES    = "vendor/qcom/kona-v2.1-iot-rb5.dtb vendor/qcom/kona-v2.1-qrd.dtb vendor/qcom/kona-v2-qrd.dtb vendor/qcom/kona-v2-mtp.dtb vendor/qcom/kona-v2.1-mtp.dtb"
KERNEL_BASE        = "0x80000000"
KERNEL_TAGS_OFFSET = "0x81900000"

KERNEL_CONFIG     ?= "vendor/kona-perf_defconfig"
KERNEL_CONFIG_qti-distro-debug ?= "vendor/kona_defconfig"

CONSOLE_PARAM     ?= ""
CONSOLE_PARAM_qti-distro-debug ?= "console=ttyMSM0,115200,n8"

KERNEL_CMD_PARAMS  = "noinitrd ${CONSOLE_PARAM} earlycon=msm_geni_serial,0xa90000 androidboot.hardware=qcom androidboot.console=ttyMSM0 androidboot.memcg=1 lpm_levels.sleep_disabled=1 video=vfb:640x400,bpp=32,memsize=3072000 msm_rtb.filter=0x237 service_locator.enable=1 androidboot.usbcontroller=a600000.dwc3 swiotlb=2048 loop.max_part=7 cgroup.memory=nokmem,nosocket reboot=panic_warm net.ifnames=0"

SERIAL_CONSOLE    ?= ""
SERIAL_CONSOLE_qti-distro-debug ?= "115200 ttyMSM0"

# bootloader configuration
EXTRA_IMAGEDEPENDS += "edk2"

PREFERRED_PROVIDER_virtual/libgles1 = "adreno"
PREFERRED_PROVIDER_virtual/libgles2 = "adreno"
PREFERRED_PROVIDER_virtual/egl      = "adreno"

# Conf with partition entries required for machine.
MACHINE_PARTITION_CONF = "qrb5165-rb5-partition.conf"

# filesystem configurations to be applied on image.
MACHINE_FSCONFIG_CONF = "qrb5165-fsconfig.conf"

# MACHINE_FEATURES ##
# qti-wifi:            Machine supports QTI WiFi solution
# qti-audio:           Machine supports QTI audio solution
# qti-adsp:            Machine supports QTI adsp solution
# qti-ab-boot:         Machine support a/b boot
# opencl:              Machine supports OpenCL driver
# qti-tflite-delegate: Machine supports tensorflow lite hardware acceleration
# WLAN soc is naples.

MACHINE_FEATURES += "qti-wifi hasting qti-adsp qti-audio qti-ab-boot qti-cdsp opencl qti-tflite-delegate qti-camera"
